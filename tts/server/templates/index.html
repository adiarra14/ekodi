{% extends "base.html" %}

{% block body %}
<div class="app-container">

  <!-- ‚îÄ‚îÄ Header ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <header class="app-header">
    <div class="app-logo">
      <img src="/static/img/ekodi_logo.jpg" alt="Ekodi" class="app-logo-img">
      <h1 data-i18n="app_name">Ekodi</h1>
    </div>
    <p class="app-subtitle" data-i18n="app_subtitle">Bamanankan Kuma Baarak…õmin…õn</p>
  </header>

  <!-- ‚îÄ‚îÄ Toolbar: Language + Theme ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <nav class="toolbar">
    <div class="toolbar-group">
      <button class="toolbar-btn lang-btn active" data-lang="bm" data-i18n="lang_bm">Bamanankan</button>
      <button class="toolbar-btn lang-btn" data-lang="fr" data-i18n="lang_fr">Faransikan</button>
      <button class="toolbar-btn lang-btn" data-lang="en" data-i18n="lang_en">Angil…õkan</button>
    </div>
    <div class="toolbar-group">
      <button class="toolbar-btn theme-btn active" data-theme="light" data-i18n="theme_light">Yeelen</button>
      <button class="toolbar-btn theme-btn" data-theme="dark" data-i18n="theme_dark">Dibi</button>
    </div>
  </nav>

  <!-- ‚îÄ‚îÄ Main Card ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <main class="main-card">

    <!-- Mode toggle: Text / Chat / TTS -->
    <div class="input-mode-toggle">
      <button class="mode-btn" id="mode-text" data-mode="text">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 3H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/><path d="M9 7h6M9 11h6M9 15h4"/></svg>
        <span data-i18n="mode_text">S…õb…õn</span>
      </button>
      <button class="mode-btn active" id="mode-chat" data-mode="chat">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
        <span data-i18n="mode_chat">AI Kuma</span>
      </button>
    </div>

    <!-- ‚îÄ‚îÄ TEXT MODE: Classic TTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div class="mode-section" id="section-text" style="display:none;">
      <div class="input-section">
        <textarea
          id="text-input"
          class="text-input"
          data-i18n-placeholder="placeholder"
          placeholder="I ka s…õb…õn k…õ yan bamanankan na..."
          maxlength="2000"
        ></textarea>
        <div class="input-footer">
          <span id="char-count" class="char-count">0 s…õb…õn</span>
          <span style="color: var(--text-muted); font-size: 0.75rem;">Ctrl+Enter</span>
        </div>
      </div>
      <div class="controls-section">
        <button id="btn-speak" class="btn btn-primary">
          <span id="btn-speak-text" data-i18n="btn_speak">Kuma</span>
        </button>
        <button id="btn-download" class="btn btn-secondary" disabled data-i18n="btn_download">A jigin</button>
        <button id="btn-clear" class="btn btn-secondary" data-i18n="btn_clear">A b…î</button>
        <div class="controls-spacer"></div>
      </div>
      <div class="status-bar">
        <div class="status-indicator">
          <span id="status-dot" class="status-dot"></span>
          <span id="status-text" data-i18n="status_ready">A lab…õnna</span>
        </div>
      </div>
      <div id="player-section" class="player-section">
        <div class="waveform-container">
          <canvas id="waveform-canvas" class="waveform-canvas"></canvas>
        </div>
        <div class="player-info">
          <span id="player-duration">‚Äî</span>
          <span id="player-size">‚Äî</span>
        </div>
      </div>
    </div>

    <!-- ‚îÄ‚îÄ CHAT MODE: Interactive AI ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div class="mode-section" id="section-chat">

      <!-- Chat messages -->
      <div class="chat-container" id="chat-container">
        <div class="chat-welcome" id="chat-welcome">
          <div class="chat-welcome-icon">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.5">
              <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
              <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
              <line x1="12" y1="19" x2="12" y2="23"/>
              <line x1="8" y1="23" x2="16" y2="23"/>
            </svg>
          </div>
          <p class="chat-welcome-text" data-i18n="chat_welcome">
            I ni ce! Ne ye Ekodi ye. I b…õ se ka kuma ni ne ye bamanankan na.
          </p>
          <p class="chat-welcome-hint" data-i18n="chat_hint">
            Mikro digi walasa ka kuma, wala i ka s…õb…õn k…õ duguma.
          </p>
        </div>
        <div id="chat-messages" class="chat-messages"></div>
      </div>

      <!-- Chat input area -->
      <div class="chat-input-area">
        <!-- Language selector: which language is the user speaking? -->
        <div class="chat-lang-row">
          <span class="chat-lang-label" data-i18n="speak_in">I b…õ kuma:</span>
          <div class="chat-lang-toggle">
            <button class="chat-lang-btn active" id="lang-fr" data-input-lang="fr">
              üá´üá∑ Fran√ßais
            </button>
            <button class="chat-lang-btn" id="lang-bm" data-input-lang="bm">
              üá≤üá± Bamanankan
            </button>
          </div>
        </div>

        <!-- Mic + text input -->
        <div class="chat-mic-row">
          <button id="btn-chat-mic" class="btn-chat-mic" aria-label="Record">
            <svg class="mic-icon" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
              <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
              <line x1="12" y1="19" x2="12" y2="23"/>
              <line x1="8" y1="23" x2="16" y2="23"/>
            </svg>
            <div class="mic-pulse"></div>
          </button>
          <p class="chat-mic-status" id="chat-mic-status" data-i18n="mic_tap">I ka digi mikro kan</p>
        </div>
        <div class="chat-text-row">
          <input
            type="text"
            id="chat-text-input"
            class="chat-text-input"
            data-i18n-placeholder="chat_type_here"
            placeholder="S…õb…õn k…õ yan..."
            maxlength="500"
          />
          <button id="btn-chat-send" class="btn-chat-send" aria-label="Send">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="22" y1="2" x2="11" y2="13"/>
              <polygon points="22 2 15 22 11 13 2 9 22 2"/>
            </svg>
          </button>
        </div>
      </div>

    </div>

  </main>

  <!-- ‚îÄ‚îÄ History (text mode only) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <section class="history-section" id="history-section" style="display:none;">
    <div class="section-header">
      <span class="section-title" data-i18n="label_history">Kuma k…îr…îw</span>
    </div>
    <div id="history-list" class="history-list"></div>
    <div id="history-empty" class="history-empty" data-i18n="history_empty">
      Kuma k…îr…î si t…õ yen
    </div>
  </section>

  <!-- ‚îÄ‚îÄ Footer ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <footer class="app-footer">
    <span data-i18n="footer_powered">Baara k…õra ni Meta MMS-TTS & OpenAI ye</span>
    &nbsp;&middot;&nbsp;
    <a href="https://github.com/adiarra14/ekodi" target="_blank" rel="noopener">GitHub</a>
  </footer>

</div>

<div id="toast-container" class="toast-container"></div>
{% endblock %}

{% block scripts %}
<script src="/static/js/app.js"></script>
{% endblock %}
